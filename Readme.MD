## âš¡âœ¨ **Batalha de Bruxos - Harry Potter** ğŸ§™â€â™‚ï¸ğŸª„

Bem-vindo a **Batalha de Bruxos**, um projeto inspirado no universo mÃ¡gico de **Harry Potter**, onde vocÃª pode escolher dois bruxos lendÃ¡rios e assistir a uma batalha de magias Ã©pica! ğŸ§™â€â™‚ï¸âš”ï¸âœ¨

---

### ğŸ“œ **Sobre o Projeto**

Neste jogo simples, desenvolvido com **Java + Spring Boot** no backend e **HTML + JS** no frontend, vocÃª poderÃ¡:
- ğŸ“‹ Cadastrar bruxos com nome e casa.
- ğŸ”® Simular uma batalha entre bruxos famosos como **Bruxo GrifinÃ³ria** ğŸ§™â€â™‚ï¸âœ¨ e **Bruxo Sonserina** ğŸğŸª„.
- ğŸ‡ Ver qual magia cada bruxo lanÃ§ou.
- ğŸ† Descobrir quem vence a batalha!

---

## ğŸ”¹ Tecnologias Utilizadas

- Java 21
- Spring Boot 3.5
- Spring Data JPA
- PostgreSQL (via Docker)
- HikariCP (connection pool)
- HTML + JavaScript (frontend simples)
- Lombok
- Swagger (documentaÃ§Ã£o da API)

---

## âš™ï¸ ConfiguraÃ§Ãµes da API

### CORS

Todos os endpoints permitem requisiÃ§Ãµes de qualquer origem:

```java
@Configuration
public class CorsConfig {
    @Bean
    public WebMvcConfigurer corsConfigurer() {
        return new WebMvcConfigurer() {
            @Override
            public void addCorsMappings(CorsRegistry registry) {
                registry.addMapping("/**")
                        .allowedOrigins("*")
                        .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS");
            }
        };
    }
}
````

| MÃ©todo | URL                                     | DescriÃ§Ã£o                                                             |
| ------ | --------------------------------------- | --------------------------------------------------------------------- |
| POST   | `/api/bruxos`                           | Cria um bruxo. Corpo JSON: `{ "nome": "Draco", "casa": "Sonserina" }` |
| GET    | `/api/bruxos`                           | Lista todos os bruxos cadastrados                                     |
| GET    | `/api/bruxos/listar-nomes`              | Lista apenas os nomes dos bruxos                                      |
| GET    | `/api/bruxos/batalha?bruxo1=X&bruxo2=Y` | Realiza batalha entre dois bruxos                                     |
| DELETE | `/api/bruxos`                           | Deleta todos os bruxos                                                |
| DELETE | `/api/bruxos/{id}`                      | Deleta um bruxo especÃ­fico pelo ID                                    |


````
ğŸ§¾ Estrutura de DTOs

BruxoRequestDTO: nome, casa

BruxoResponseDTO: id, nome, casa, feitico

BatalhaResponseDTO: nomeBruxo1, feiticoBruxo1, nomeBruxo2, feiticoBruxo2, vencedor

````

````
ğŸ’» Frontend

Arquivo: index.html (simples interface para iniciar batalhas)

Seleciona dois bruxos

Dispara uma requisiÃ§Ã£o para /api/bruxos/batalha

Exibe resultado da batalha em tela

````

```

ğŸ—‚ Estrutura de Classes

model/Bruxo (abstrato)

model/BruxoGrifinoria e model/BruxoSonserina

model/Magia (interface para lanÃ§ar feitiÃ§o)

repository/BruxoRepository

service/BruxoService

controller/BruxoController

dto/* (request e response)

exception/BruxoNotFoundException e GlobalExceptionHandler

````

# ğŸ˜ ConfiguraÃ§Ã£o PostgreSQL com Docker

docker-compose.yml:

````Yaml
version: '3.9'
services:
batalha:
image: postgres:latest
container_name: batalha
restart: always
environment:
POSTGRES_USER: harry
POSTGRES_PASSWORD: potter
POSTGRES_DB: batalha
ports:
- "5432:5432"
volumes:
- postgres_data:/var/lib/postgresql/data
- ./init-db:/docker-entrypoint-initdb.d

pgadmin:
image: dpage/pgadmin4:latest
container_name: pgadmin
restart: always
environment:
PGADMIN_DEFAULT_EMAIL: admin@harrypotter.com
PGADMIN_DEFAULT_PASSWORD: 123456
ports:
- "5050:80"
depends_on:
- batalha

volumes:
postgres_data:
````

```properties
# ===============================
# ğŸ”— CONEXÃƒO COM O BANCO POSTGRES
# ===============================
spring.datasource.url=jdbc:postgresql://localhost:5432/batalha
spring.datasource.username=harry
spring.datasource.password=potter
spring.datasource.driver-class-name=org.postgresql.Driver

# ===============================
# âš™ï¸ JPA / HIBERNATE
# ===============================
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# ===============================
# ğŸš€ HIKARI CONNECTION POOL
# ===============================
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.pool-name=HikariCP
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.validation-timeout=5000

# ===============================
# ğŸ§¾ LOGGING
# ===============================
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.springframework.jdbc.core=DEBUG
logging.level.com.br.harrypotter=DEBUG

# ===============================
# ğŸŒ SERVIDOR WEB
# ===============================
server.port=8080
server.servlet.context-path=/

# ===============================
# ğŸ§© TESTES DE INTEGRAÃ‡ÃƒO
# ===============================
spring.test.database.replace=none
spring.jpa.properties.hibernate.default_schema=public
````

# ğŸ“– Funcionamento do Swagger no Projeto Harry Potter

O Swagger (via SpringDoc) foi configurado para gerar a **documentaÃ§Ã£o interativa da API** automaticamente a partir dos seus controllers e endpoints.

---

## 1ï¸âƒ£ URL de Acesso

ApÃ³s iniciar a aplicaÃ§Ã£o (`Application.java`), abra o navegador e acesse:

http://localhost:8080/swagger-ui.html


Isso abrirÃ¡ a interface do Swagger UI, onde vocÃª verÃ¡ todos os endpoints disponÃ­veis do projeto, organizados por **tags** (ex.: "Bruxos").

O JSON da documentaÃ§Ã£o pode ser acessado diretamente em:

http://localhost:8080/v3/api-docs



---

## 2ï¸âƒ£ Funcionalidades do Swagger

- **Listar endpoints**: Todos os mÃ©todos do `BruxoController` sÃ£o exibidos com suas rotas, mÃ©todos HTTP e descriÃ§Ãµes.
- **Testar requisiÃ§Ãµes**: VocÃª pode enviar requisiÃ§Ãµes diretamente pelo Swagger UI, preenchendo parÃ¢metros e bodies.
- **Visualizar respostas**: O Swagger mostra o modelo de dados (`BruxoRequestDTO`, `BruxoResponseDTO`, `BatalhaResponseDTO`) e os cÃ³digos de resposta (`200`, `400`, `404`, etc.).
- **Filtros de pacotes e paths**: Apenas endpoints dentro de `com.br.harrypotter.controller` e com path `/api/**` estÃ£o disponÃ­veis.

---

## 3ï¸âƒ£ Exemplos de RequisiÃ§Ãµes

### Criar um bruxo

POST /api/bruxos
Body:
{
"nome": "Harry Potter",
"casa": "GrifinÃ³ria",
"poder": 85
}


### Listar Bruxos

GET /api/bruxos

### Realizar uma batalha entre dois bruxos

GET /api/bruxos/batalha?bruxo1=Harry&bruxo2=Draco

### Deletar um bruxo por ID

DELETE /api/bruxos/{id}

### Deletar todos os bruxos

DELETE /api/bruxos


---

## 4ï¸âƒ£ ObservaÃ§Ãµes

- O Swagger UI Ã© **interativo**, permitindo testar todos os endpoints sem precisar de ferramentas externas.
- Todos os DTOs, parÃ¢metros e respostas estÃ£o documentados automaticamente via **anotaÃ§Ãµes `@Operation`, `@ApiResponse` e `@Parameter`** no controller.
- Qualquer alteraÃ§Ã£o nos controllers serÃ¡ refletida automaticamente no Swagger ao reiniciar a aplicaÃ§Ã£o.


## VocÃª ainda pode acessar o index.html dentro de resources>static:

**Abra o arquivo index.html em um navegador de sua preferÃªncia.**

- Cadastre os bruxos via requisiÃ§Ã£o postman: 

http://localhost:8080/api/bruxos

{
"nome": "Marlene",
"casa": "Sonserina"
}



4ï¸âƒ£ **Escolha os bruxos e clique em â€œIniciar Batalhaâ€**
âš¡âœ¨ğŸ§™â€â™‚ï¸ğŸ’¥


